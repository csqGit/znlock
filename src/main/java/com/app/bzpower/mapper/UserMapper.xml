<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.app.bzpower.dao.UserMapper">
  <resultMap id="BaseResultMap" type="com.app.bzpower.entity.User">
    <id column="uid" jdbcType="INTEGER" property="id" />
    <result column="username" jdbcType="VARCHAR" property="username" />
    <result column="realname" jdbcType="VARCHAR" property="realname" />
    <result column="password" jdbcType="VARCHAR" property="password" />
    <result column="phone" jdbcType="VARCHAR" property="phone" />
    <result column="voltage" jdbcType="VARCHAR" property="voltage" />
    <result column="remarks" jdbcType="VARCHAR" property="remarks" />
    <association property="companyId" javaType="com.app.bzpower.entity.Company">
    	<id column="cid" property="id" />
    	<result column="companyName" jdbcType="VARCHAR" property="companyname" />
    	<result column="voltage" jdbcType="VARCHAR" property="voltage" />
    </association>
    <association property="transformersubId" javaType="com.app.bzpower.entity.TransformerSub">
    	<id column="tid" property="id" />
    	<result column="transformersub" jdbcType="VARCHAR" property="transformersub" />
    	<result column="voltage" jdbcType="VARCHAR" property="voltage" />
    </association>
  </resultMap>
  
  <sql id="Base_Column_List">
    uid, username, realname, password, phone, voltage, company_id, transformersub_id, 
    remarks
  </sql>
  
  
  <select id="selectUserList" parameterType="com.app.bzpower.entity.User" resultMap="BaseResultMap">
   	select 
   	u.uid, u.username, u.realname, u.password, u.phone, 
   	u.voltage, u.company_id, u.transformersub_id, t.transformersub
   	from user u
   	inner join 
   	transformersub t
   	on t.tid = u.transformersub_id
   	where 1=1
   	and u.voltage = #{admin.voltage} and u.company_id = #{admin.companyId.id}
   	<if test="pageData.limit != 0">
   		limit #{pageData.startPage}, #{pageData.limit}
   	</if>
  </select>
  
  
  <select id="selectUserListByCompanyId"  resultMap="BaseResultMap">
   	select 
   	u.uid, u.username, u.realname, u.password, u.phone, 
   	u.voltage, u.company_id, u.transformersub_id, t.transformersub
   	from user u
   	inner join 
   	transformersub t
   	on t.tid = u.transformersub_id
   	where 1=1
   	and u.voltage = #{voltage} and u.company_id = #{companyId}
   
  </select>
  
  
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
   select 
   	u.uid, u.username, u.realname, u.password, u.phone, 
   	u.voltage, u.company_id, u.transformersub_id, t.tid, t.transformersub
   	from user u
   	inner join 
   	transformersub t
   	on t.tid = u.transformersub_id
   	where u.uid = #{id}
  </select>
  
  
  <select id="selectUserByPhone" parameterType="java.lang.String" resultMap="BaseResultMap">
   select 
   	u.uid, u.username, u.realname, u.password, u.phone, 
   	u.voltage, u.company_id, u.transformersub_id, t.tid, t.transformersub
   	from user u
   	inner join 
   	transformersub t
   	on t.tid = u.transformersub_id
   	where u.phone = #{phone}
  </select>
  
  
  
  <update id="updateByPrimaryKeySelective" parameterType="com.app.bzpower.entity.User">
   
    update user
    <set>
      <if test="username != null">
        username = #{username,jdbcType=VARCHAR},
      </if>
      <if test="realname != null">
        realname = #{realname,jdbcType=VARCHAR},
      </if>
      <if test="password != null">
        password = #{password,jdbcType=VARCHAR},
      </if>
      <if test="phone != null">
        phone = #{phone,jdbcType=VARCHAR},
      </if>
      <if test="voltage != null">
        voltage = #{voltage,jdbcType=VARCHAR},
      </if>
      
      <if test="transformersubId != null">
        transformersub_id = #{transformersubId.id,jdbcType=INTEGER},
      </if>
      <if test="remarks != null">
        remarks = #{remarks,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  
  
  
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
   delete from user where id = #{id}
  </delete>
 
 
 <insert id="insertSelective" parameterType="com.app.bzpower.entity.User">
   
    insert into user
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        uid,
      </if>
      <if test="username != null">
        username,
      </if>
      <if test="realname != null">
        realname,
      </if>
      <if test="password != null">
        password,
      </if>
      <if test="phone != null">
        phone,
      </if>
      <if test="voltage != null">
        voltage,
      </if>
      <if test="companyId != null">
        company_id,
      </if>
      <if test="transformersubId != null">
        transformersub_id,
      </if>
      <if test="remarks != null">
        remarks,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=INTEGER},
      </if>
      <if test="username != null">
        #{username,jdbcType=VARCHAR},
      </if>
      <if test="realname != null">
        #{realname,jdbcType=VARCHAR},
      </if>
      <if test="password != null">
        #{password,jdbcType=VARCHAR},
      </if>
      <if test="phone != null">
        #{phone,jdbcType=VARCHAR},
      </if>
      <if test="voltage != null">
        #{voltage,jdbcType=VARCHAR},
      </if>
      <if test="companyId != null">
        #{companyId.id,jdbcType=INTEGER},
      </if>
      <if test="transformersubId != null">
        #{transformersubId.id,jdbcType=INTEGER},
      </if>
      <if test="remarks != null">
        #{remarks,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  
  
  
  <select id="countByExample" parameterType="com.app.bzpower.entity.User" resultType="java.lang.Long">
    
    select count(uid) from user where 1 = 1
    <if test="companyId != null">
    	and company_id = #{companyId.id}
    </if>
    <if test="voltage != null">
    	and voltage =  #{voltage}
    </if>
    
  </select>
  
  <!-- 
  
  
  <delete id="deleteByExample" parameterType="com.app.bzpower.entity.User">
   
  </delete>
  <insert id="insert" parameterType="com.app.bzpower.entity.User">
    
    insert into user (id, username, realname, 
      password, phone, voltage, 
      company_id, transformersub_id, remarks
      )
    values (#{id,jdbcType=INTEGER}, #{username,jdbcType=VARCHAR}, #{realname,jdbcType=VARCHAR}, 
      #{password,jdbcType=VARCHAR}, #{phone,jdbcType=VARCHAR}, #{voltage,jdbcType=VARCHAR}, 
      #{companyId,jdbcType=INTEGER}, #{transformersubId,jdbcType=INTEGER}, #{remarks,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.app.bzpower.entity.User">
   
    insert into user
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        id,
      </if>
      <if test="username != null">
        username,
      </if>
      <if test="realname != null">
        realname,
      </if>
      <if test="password != null">
        password,
      </if>
      <if test="phone != null">
        phone,
      </if>
      <if test="voltage != null">
        voltage,
      </if>
      <if test="companyId != null">
        company_id,
      </if>
      <if test="transformersubId != null">
        transformersub_id,
      </if>
      <if test="remarks != null">
        remarks,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=INTEGER},
      </if>
      <if test="username != null">
        #{username,jdbcType=VARCHAR},
      </if>
      <if test="realname != null">
        #{realname,jdbcType=VARCHAR},
      </if>
      <if test="password != null">
        #{password,jdbcType=VARCHAR},
      </if>
      <if test="phone != null">
        #{phone,jdbcType=VARCHAR},
      </if>
      <if test="voltage != null">
        #{voltage,jdbcType=VARCHAR},
      </if>
      <if test="companyId != null">
        #{companyId,jdbcType=INTEGER},
      </if>
      <if test="transformersubId != null">
        #{transformersubId,jdbcType=INTEGER},
      </if>
      <if test="remarks != null">
        #{remarks,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  
  <update id="updateByExampleSelective" parameterType="map">
   
    update user
    <set>
      <if test="record.id != null">
        id = #{record.id,jdbcType=INTEGER},
      </if>
      <if test="record.username != null">
        username = #{record.username,jdbcType=VARCHAR},
      </if>
      <if test="record.realname != null">
        realname = #{record.realname,jdbcType=VARCHAR},
      </if>
      <if test="record.password != null">
        password = #{record.password,jdbcType=VARCHAR},
      </if>
      <if test="record.phone != null">
        phone = #{record.phone,jdbcType=VARCHAR},
      </if>
      <if test="record.voltage != null">
        voltage = #{record.voltage,jdbcType=VARCHAR},
      </if>
      <if test="record.companyId != null">
        company_id = #{record.companyId,jdbcType=INTEGER},
      </if>
      <if test="record.transformersubId != null">
        transformersub_id = #{record.transformersubId,jdbcType=INTEGER},
      </if>
      <if test="record.remarks != null">
        remarks = #{record.remarks,jdbcType=VARCHAR},
      </if>
    </set>
    
  </update>
  <update id="updateByExample" parameterType="map">
   
    update user
    set id = #{record.id,jdbcType=INTEGER},
      username = #{record.username,jdbcType=VARCHAR},
      realname = #{record.realname,jdbcType=VARCHAR},
      password = #{record.password,jdbcType=VARCHAR},
      phone = #{record.phone,jdbcType=VARCHAR},
      voltage = #{record.voltage,jdbcType=VARCHAR},
      company_id = #{record.companyId,jdbcType=INTEGER},
      transformersub_id = #{record.transformersubId,jdbcType=INTEGER},
      remarks = #{record.remarks,jdbcType=VARCHAR}
    
  </update>
  
  <update id="updateByPrimaryKey" parameterType="com.app.bzpower.entity.User">
    
    update user
    set username = #{username,jdbcType=VARCHAR},
      realname = #{realname,jdbcType=VARCHAR},
      password = #{password,jdbcType=VARCHAR},
      phone = #{phone,jdbcType=VARCHAR},
      voltage = #{voltage,jdbcType=VARCHAR},
      company_id = #{companyId,jdbcType=INTEGER},
      transformersub_id = #{transformersubId,jdbcType=INTEGER},
      remarks = #{remarks,jdbcType=VARCHAR}
    where id = #{id,jdbcType=INTEGER}
  </update> -->
</mapper>